<% include ../_partials/header %>
<%= event %>
<hr>

<form>
	<% persons.forEach(function(name){ %>
		
	<% if(event.persons.indexOf(name._id) > -1) { %>

	 <input type="checkbox" name="person" value="<%= name._id %>" checked><%= name.first_name %> <%= name.last_name %> <br>

	<% } else { %>

	<input type="checkbox" name="person" value="<%= name._id %>"><%= name.first_name %> <%= name.last_name %> <br>
		<% } %>
	<% }) %>
</form>

<script>
$('input:checkbox').change(
    function(){
       if ($(this).is(':checked')) {
       		$.ajax({
			  type: "POST",
			  url: location.pathname,
			  data: {'person_id': this.value},
			  success: "success",
			  dataType: "dataType"
			});
           return console.log("add " + this.value);
        }
       if ($(this).not(':checked')) {
       		$.ajax({
			  type: "DELETE",
			  url: location.pathname,
			  data: {'person_id': this.value},
			  success: "success",
			  dataType: "dataType"
			});
           return console.log("remove " + this.value);
        }
    });
</script>


<!-- <form action="/add_event" method="post" accept-charset="utf-8">
		name: <input type "text" name="name" /> <br>	
		description: <input type "text" name="description" /><br>

		<input type ="submit" value="Save">
	</form> -->